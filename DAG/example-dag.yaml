resources:
  jobs:
    data_pipeline_ab_inbev:
      name: data_pipeline_ab_inbev
      email_notifications:
        on_failure:
          - dssampaio2011@gmail.com
      schedule:
        quartz_cron_expression: 56 0 6 * * ?
        timezone_id: America/Sao_Paulo
        pause_status: UNPAUSED
      tasks:
        - task_key: bronze_api_data
          notebook_task:
            notebook_path: 01_Bronze/fetch_api_breweries
            source: GIT
          existing_cluster_id: 0131-233618-fms20mj4
          max_retries: 1
          min_retry_interval_millis: 300000
          email_notifications:
            on_failure:
              - dssampaio2011@gmail.com
        - task_key: silver_breweries
          depends_on:
            - task_key: bronze_api_data
          notebook_task:
            notebook_path: 02_Silver/silver_breweries
            source: GIT
          max_retries: 1
          min_retry_interval_millis: 300000
          email_notifications:
            on_failure:
              - dssampaio2011@gmail.com
          environment_key: silver_breweries_environment
        - task_key: gold_breweries_agg
          depends_on:
            - task_key: silver_breweries
          notebook_task:
            notebook_path: 03_Gold/breweries_agg
            source: GIT
          max_retries: 1
          min_retry_interval_millis: 300000
          email_notifications:
            on_failure:
              - dssampaio2011@gmail.com
          environment_key: silver_breweries_environment
      git_source:
        git_url: https://github.com/eumatheussampaio/abinbev-lake
        git_provider: gitHub
        git_branch: main
      queue:
        enabled: true
      environments:
        - environment_key: silver_breweries_environment
          spec:
            environment_version: "4"
      performance_target: PERFORMANCE_OPTIMIZED
